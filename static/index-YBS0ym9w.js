import{B as Y,E as x,C as ee}from"./element-V6-G1TdP.js";import{u as ae}from"./usePagination-rdI7J7GV.js";import{f as te}from"./index-NbshIwLH.js";import{a as w,C as le,U as oe,D as ne,G as se,L as re,S as ie}from"./index-MG27Wz5u.js";import{L as ue}from"./index-ylSDs0Hy.js";import{l as de,r as c,Z as pe,b as ce,e as me,ag as s,aq as L,m as _,p as _e,V as v,M as g,O as e,u as r,S as i,q as y,T as a,R as D}from"./vue-ZDMaqQfr.js";import{_ as fe}from"./index-7Q0_XLUl.js";import"./vxe-SD4sv8pp.js";const ve={class:"app-container"},ge={class:"toolbar-wrapper"},be={class:"table-wrapper"},he={class:"pager-wrapper"},Ce=de({name:"group",__name:"index",setup(we){const V=c(!1),{paginationData:u,handleCurrentChange:E,handleSizeChange:$}=ae(),d=c(!1),k=c(null),n=c({}),q=pe({name:[{required:!0,trigger:"blur",message:"请输入名称"}],sort:[{required:!0,trigger:"blur",message:"请输入排序"}],status:[{required:!0,trigger:"change",message:"请选择启用状态"}]}),O=()=>{var t;(t=k.value)==null||t.validate((o,p)=>{o?f.value===void 0?le(n.value).then(()=>{x.success("新增成功"),b()}).finally(()=>{d.value=!1}):oe(f.value,{...n.value}).then(()=>{x.success("修改成功"),b()}).finally(()=>{d.value=!1}):console.error("表单校验不通过",p)})},M=t=>{n.value.parent_id=t.id,d.value=!0},R=()=>{var t;f.value=void 0,(t=k.value)==null||t.resetFields(),n.value={}},G=t=>{ee.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{ne({id:[t.id]}).then(()=>{x.success("删除成功"),b()})})},f=c(void 0),I=t=>{se(t.id).then(o=>{f.value=o.data.id,Object.assign(n.value,o.data||{}),d.value=!0})},z=c([]),b=()=>{V.value=!0,re({page:u.currentPage,page_size:u.pageSize}).then(t=>{u.total=t.data.total,z.value=t.data.list,j()}).catch(()=>{z.value=[]}).finally(()=>{V.value=!1})},N=c([]);(()=>{ue({page:1,page_size:999}).then(t=>{N.value=t.data.list})})();const F={emitPath:!1,checkStrictly:!0},S=c([]),j=()=>{ie().then(t=>{S.value=t.data,S.value.unshift({value:0,label:"顶级部门"})})};ce([()=>u.currentPage,()=>u.pageSize],b,{immediate:!0});const P=me(()=>t=>te(t));return(t,o)=>{const p=s("el-button"),m=s("el-table-column"),H=s("el-table"),Z=s("el-pagination"),A=s("el-card"),U=s("el-input"),h=s("el-form-item"),J=s("el-cascader"),T=s("el-radio"),K=s("el-radio-group"),Q=s("el-form"),W=s("el-dialog"),C=L("permission"),X=L("loading");return _(),_e("div",ve,[v((_(),g(A,{shadow:"never"},{default:e(()=>[y("div",ge,[y("div",null,[v((_(),g(p,{type:"primary",icon:r(Y),onClick:o[0]||(o[0]=l=>d.value=!0)},{default:e(()=>[i("新增部门")]),_:1},8,["icon"])),[[C,r(w)+"_POST"]])])]),y("div",be,[a(H,{data:z.value,"row-key":"id"},{default:e(()=>[a(m,{prop:"name",label:"部门名称","min-width":"130"}),a(m,{prop:"sort",label:"排序","min-width":"110"}),a(m,{prop:"status",label:"启用","min-width":"110"},{default:e(l=>[i(D(l.row.status?"是":"否"),1)]),_:1}),a(m,{prop:"created_at",label:"创建时间","min-width":"160",sortable:""},{default:e(l=>[i(D(P.value(l.row.created_at)),1)]),_:1}),a(m,{prop:"updated_at",label:"最后更新时间","min-width":"160",sortable:""},{default:e(l=>[i(D(P.value(l.row.updated_at)),1)]),_:1}),a(m,{label:"操作",width:"200",align:"center"},{default:e(l=>[v((_(),g(p,{type:"primary",text:"",bg:"",size:"small",onClick:B=>M(l.row)},{default:e(()=>[i("子部门")]),_:2},1032,["onClick"])),[[C,r(w)+"_POST"]]),v((_(),g(p,{type:"primary",text:"",bg:"",size:"small",onClick:B=>I(l.row)},{default:e(()=>[i("修改")]),_:2},1032,["onClick"])),[[C,r(w)+"/:id_PUT"]]),v((_(),g(p,{type:"danger",text:"",bg:"",size:"small",onClick:B=>G(l.row)},{default:e(()=>[i("删除")]),_:2},1032,["onClick"])),[[C,r(w)+"_DELETE"]])]),_:1})]),_:1},8,["data"])]),y("div",he,[a(Z,{background:"",layout:r(u).layout,"page-sizes":r(u).pageSizes,total:r(u).total,"page-size":r(u).pageSize,currentPage:r(u).currentPage,onSizeChange:r($),onCurrentChange:r(E)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])]),_:1})),[[X,V.value]]),a(W,{modelValue:d.value,"onUpdate:modelValue":o[6]||(o[6]=l=>d.value=l),title:f.value===void 0?"新增":"修改",onClose:R,width:"30%"},{footer:e(()=>[a(p,{onClick:o[5]||(o[5]=l=>d.value=!1)},{default:e(()=>[i("取消")]),_:1}),a(p,{type:"primary",onClick:O},{default:e(()=>[i("确认")]),_:1})]),default:e(()=>[a(Q,{ref_key:"formRef",ref:k,model:n.value,rules:q,"label-width":"100px","label-position":"right"},{default:e(()=>[a(h,{prop:"name",label:"部门名称"},{default:e(()=>[a(U,{modelValue:n.value.name,"onUpdate:modelValue":o[1]||(o[1]=l=>n.value.name=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(h,{prop:"parentId",label:"上级部门"},{default:e(()=>[a(J,{modelValue:n.value.parent_id,"onUpdate:modelValue":o[2]||(o[2]=l=>n.value.parent_id=l),options:S.value,props:F,placeholder:"请选择","show-all-levels":!1,clearable:""},null,8,["modelValue","options"])]),_:1}),a(h,{prop:"sort",label:"排序"},{default:e(()=>[a(U,{modelValue:n.value.sort,"onUpdate:modelValue":o[3]||(o[3]=l=>n.value.sort=l),modelModifiers:{number:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(h,{prop:"status",label:"是否启用"},{default:e(()=>[a(K,{modelValue:n.value.status,"onUpdate:modelValue":o[4]||(o[4]=l=>n.value.status=l)},{default:e(()=>[a(T,{label:1},{default:e(()=>[i("是")]),_:1}),a(T,{label:0},{default:e(()=>[i("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),Te=fe(Ce,[["__scopeId","data-v-c265c326"]]);export{Te as default};
