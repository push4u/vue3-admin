import{u as A}from"./usePagination-rdI7J7GV.js";import{i as H,_ as I}from"./index-PXxC_NGL.js";import{f as Z}from"./index-Tr9X6QwQ.js";import{a as w,D as j,L as G}from"./index-otQi41h6.js";import{C as J,E as K}from"./element-V6-G1TdP.js";import{l as Q,r as g,Z as W,b as X,e as Y,ag as i,aq as P,m as c,p as ee,V as v,M as b,O as l,T as e,S as m,u as r,q as y,R as ae}from"./vue-ZDMaqQfr.js";import"./vxe-SD4sv8pp.js";const le={class:"app-container"},te={class:"toolbar-wrapper"},oe={class:"table-wrapper"},ne={class:"pager-wrapper"},re=Q({name:"file",__name:"index",setup(se){const _=g(!1),{paginationData:n,handleCurrentChange:B,handleSizeChange:T}=A(),E=H(),U="",k=g([]),L=s=>{J.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{j({id:[s.id]}).then(()=>{K.success("删除成功"),f()})})},V=g([]),C=g(null),a=W({created_by:void 0,hash:void 0,key:void 0,name:void 0,tag:void 0,url:void 0}),f=()=>{_.value=!0,G({page:n.currentPage,page_size:n.pageSize,created_by:a.created_by||void 0,hash:a.hash||void 0,key:a.key||void 0,name:a.name||void 0,tag:a.tag||void 0,url:a.url||void 0}).then(s=>{n.total=s.data.total,V.value=s.data.list}).catch(()=>{V.value=[]}).finally(()=>{_.value=!1})},z=()=>{n.currentPage===1?f():n.currentPage=1},F=()=>{var s;(s=C.value)==null||s.resetFields(),z()},M=()=>{f()};X([()=>n.currentPage,()=>n.pageSize],f,{immediate:!0});const N=Y(()=>s=>Z(s));return(s,o)=>{const p=i("el-input"),d=i("el-form-item"),h=i("el-button"),R=i("el-form"),S=i("el-card"),$=i("el-upload"),u=i("el-table-column"),q=i("el-table"),O=i("el-pagination"),x=P("loading"),D=P("permission");return c(),ee("div",le,[v((c(),b(S,{shadow:"never",class:"search-wrapper"},{default:l(()=>[e(R,{ref_key:"searchFormRef",ref:C,inline:!0,model:a},{default:l(()=>[e(d,{prop:"createdBy",label:"创建人"},{default:l(()=>[e(p,{modelValue:a.created_by,"onUpdate:modelValue":o[0]||(o[0]=t=>a.created_by=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(d,{prop:"hash",label:"文件hash"},{default:l(()=>[e(p,{modelValue:a.hash,"onUpdate:modelValue":o[1]||(o[1]=t=>a.hash=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(d,{prop:"key",label:"编号"},{default:l(()=>[e(p,{modelValue:a.key,"onUpdate:modelValue":o[2]||(o[2]=t=>a.key=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(d,{prop:"name",label:"文件名"},{default:l(()=>[e(p,{modelValue:a.name,"onUpdate:modelValue":o[3]||(o[3]=t=>a.name=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(d,{prop:"tag",label:"文件标签"},{default:l(()=>[e(p,{modelValue:a.tag,"onUpdate:modelValue":o[4]||(o[4]=t=>a.tag=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(d,{prop:"url",label:"文件地址"},{default:l(()=>[e(p,{modelValue:a.url,"onUpdate:modelValue":o[5]||(o[5]=t=>a.url=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(d,null,{default:l(()=>[e(h,{type:"primary",onClick:z},{default:l(()=>[m("查询")]),_:1}),e(h,{onClick:F},{default:l(()=>[m("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})),[[x,_.value]]),v((c(),b(S,{shadow:"never"},{default:l(()=>[y("div",te,[y("div",null,[e($,{"file-list":k.value,"onUpdate:fileList":o[6]||(o[6]=t=>k.value=t),class:"upload-demo",action:`${r(U)}${r(w)}`,"show-file-list":!1,headers:{Authorization:"Bearer "+r(E)},"on-success":M},{default:l(()=>[v((c(),b(h,{type:"primary"},{default:l(()=>[m("上传文件")]),_:1})),[[D,r(w)+"_POST"]])]),_:1},8,["file-list","action","headers"])])]),y("div",oe,[e(q,{data:V.value},{default:l(()=>[e(u,{prop:"hash",label:"hash","min-width":"110"}),e(u,{prop:"key",label:"编号","min-width":"110"}),e(u,{prop:"name",label:"文件名","min-width":"160"}),e(u,{prop:"tag",label:"文件标签","min-width":"110"}),e(u,{prop:"url",label:"文件地址","min-width":"110"}),e(u,{prop:"created_at",label:"时间","min-width":"110"},{default:l(t=>[m(ae(N.value(t.row.created_at)),1)]),_:1}),e(u,{label:"操作",width:"150",align:"center"},{default:l(t=>[v((c(),b(h,{type:"danger",text:"",bg:"",size:"small",onClick:ie=>L(t.row)},{default:l(()=>[m("删除")]),_:2},1032,["onClick"])),[[D,r(w)+"_DELETE"]])]),_:1})]),_:1},8,["data"])]),y("div",ne,[e(O,{background:"",layout:r(n).layout,"page-sizes":r(n).pageSizes,total:r(n).total,"page-size":r(n).pageSize,currentPage:r(n).currentPage,onSizeChange:r(T),onCurrentChange:r(B)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])]),_:1})),[[x,_.value]])])}}}),he=I(re,[["__scopeId","data-v-f25b34c2"]]);export{he as default};
