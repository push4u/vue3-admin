import{u as E}from"./usePagination-rdI7J7GV.js";import{f as H}from"./index-Tr9X6QwQ.js";import{g as J}from"./dict-uZgWI9Aa.js";import{b as M}from"./index-npk5LdAu.js";import{l as Z,r as g,Z as j,b as A,e as G,ag as n,aq as K,m as u,p as v,V as D,M as m,O as o,F as Q,u as s,a7 as W,T as e,S as b,q as h,R as X}from"./vue-ZDMaqQfr.js";import{_ as Y}from"./index-PXxC_NGL.js";import"./element-V6-G1TdP.js";import"./index-pKLb9-BE.js";import"./index-75tIVHXn.js";import"./vxe-SD4sv8pp.js";const $={class:"app-container"},ee={class:"table-wrapper"},ae={key:1},te={class:"pager-wrapper"},oe=Z({name:"logRecordUser",__name:"user",setup(le){const c=g(!1),{paginationData:r,handleCurrentChange:U,handleSizeChange:P}=E(),f=g([]),V=g(null),a=j({page:void 0,pageSize:void 0,action:void 0,operator_name:void 0,data_id:void 0,data_name:void 0,ip:void 0,content:void 0,data_type:void 0}),R=J("action"),w=()=>{c.value=!0,M({page:r.currentPage,page_size:r.pageSize,action:a.action||void 0,operator_name:a.operator_name||void 0,data_id:a.data_id||void 0,data_name:a.data_name||void 0,ip:a.ip||void 0,content:a.content||void 0,data_type:a.data_type||void 0}).then(p=>{r.total=p.data.total,f.value=p.data.list}).catch(()=>{f.value=[]}).finally(()=>{c.value=!1})},y=()=>{r.currentPage===1?w():r.currentPage=1},x=()=>{var p;(p=V.value)==null||p.resetFields(),y()};A([()=>r.currentPage,()=>r.pageSize],w,{immediate:!0});const F=G(()=>p=>H(p));return(p,l)=>{const B=n("el-option"),N=n("el-select"),i=n("el-form-item"),_=n("el-input"),C=n("el-button"),T=n("el-form"),z=n("el-card"),d=n("el-table-column"),S=n("el-table"),I=n("View"),L=n("el-icon"),O=n("el-popover"),q=n("el-pagination"),k=K("loading");return u(),v("div",$,[D((u(),m(z,{shadow:"never",class:"search-wrapper"},{default:o(()=>[e(T,{ref_key:"searchFormRef",ref:V,inline:!0,model:a},{default:o(()=>[e(i,{prop:"action",label:"请求动作"},{default:o(()=>[e(N,{modelValue:a.action,"onUpdate:modelValue":l[0]||(l[0]=t=>a.action=t),placeholder:"请求动作",clearable:""},{default:o(()=>[(u(!0),v(Q,null,W(s(R),t=>(u(),m(B,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{prop:"operator_name",label:"操作人"},{default:o(()=>[e(_,{modelValue:a.operator_name,"onUpdate:modelValue":l[1]||(l[1]=t=>a.operator_name=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(i,{prop:"data_id",label:"数据ID"},{default:o(()=>[e(_,{modelValue:a.data_id,"onUpdate:modelValue":l[2]||(l[2]=t=>a.data_id=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(i,{prop:"data_name",label:"数据名称"},{default:o(()=>[e(_,{modelValue:a.data_name,"onUpdate:modelValue":l[3]||(l[3]=t=>a.data_name=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(i,{prop:"ip",label:"ip地址"},{default:o(()=>[e(_,{modelValue:a.ip,"onUpdate:modelValue":l[4]||(l[4]=t=>a.ip=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(i,{prop:"content",label:"日志内容"},{default:o(()=>[e(_,{modelValue:a.content,"onUpdate:modelValue":l[5]||(l[5]=t=>a.content=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(i,{prop:"data_type",label:"数据类型"},{default:o(()=>[e(_,{modelValue:a.data_type,"onUpdate:modelValue":l[6]||(l[6]=t=>a.data_type=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(i,null,{default:o(()=>[e(C,{type:"primary",onClick:y},{default:o(()=>[b("查询")]),_:1}),e(C,{onClick:x},{default:o(()=>[b("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})),[[k,c.value]]),D((u(),m(z,{shadow:"never"},{default:o(()=>[h("div",ee,[e(S,{data:f.value},{default:o(()=>[e(d,{prop:"content",label:"日志内容","min-width":"110"}),e(d,{label:"数据变动",prop:"diff",sortable:"custom",width:"160"},{default:o(t=>[h("div",null,[t.row.diff?(u(),m(O,{key:0,placement:"left",trigger:"hover",width:"450"},{reference:o(()=>[e(L,null,{default:o(()=>[e(I)]),_:1})]),default:o(()=>[e(S,{data:JSON.parse(t.row.diff),size:"small",class:"special-diff-getRowClass"},{default:o(()=>[e(d,{width:"150",property:"name",label:"名称"}),e(d,{width:"150",property:"old",label:"旧值"}),e(d,{width:"150",property:"new",label:"新值"})]),_:2},1032,["data"])]),_:2},1024)):(u(),v("span",ae,"无"))])]),_:1}),e(d,{prop:"operator_name",label:"操作人","min-width":"160"}),e(d,{prop:"ip",label:"操作IP","min-width":"110"}),e(d,{prop:"data_type",label:"数据类型","min-width":"160"}),e(d,{prop:"created_at",label:"操作时间","min-width":"110"},{default:o(t=>[b(X(F.value(t.row.updated_at)),1)]),_:1})]),_:1},8,["data"])]),h("div",te,[e(q,{background:"",layout:s(r).layout,"page-sizes":s(r).pageSizes,total:s(r).total,"page-size":s(r).pageSize,currentPage:s(r).currentPage,onSizeChange:s(P),onCurrentChange:s(U)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])]),_:1})),[[k,c.value]])])}}}),fe=Y(oe,[["__scopeId","data-v-29692279"]]);export{fe as default};
