import{u as j}from"./usePagination-rdI7J7GV.js";import{j as A,_ as H}from"./index-6ZzXudcC.js";import{f as I}from"./index-j43B_aRU.js";import{a as w,D as Z,L as G}from"./index-5nTVyIsb.js";import{C as J,E as K}from"./element-V6-G1TdP.js";import{l as Q,r as g,Z as W,b as X,e as Y,ag as i,aq as P,m as c,p as ee,V as v,M as b,O as t,T as e,S as m,u as r,q as y,R as ae}from"./vue-ZDMaqQfr.js";import"./vxe-SD4sv8pp.js";const te={class:"app-container"},le={class:"toolbar-wrapper"},oe={class:"table-wrapper"},ne={class:"pager-wrapper"},re=Q({name:"file",__name:"index",setup(se){const _=g(!1),{paginationData:n,handleCurrentChange:B,handleSizeChange:T}=j(),E=A(),U="https://demo.push4u.com",k=g([]),L=s=>{J.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Z({id:[s.id]}).then(()=>{K.success("删除成功"),h()})})},V=g([]),C=g(null),a=W({created_by:void 0,hash:void 0,key:void 0,name:void 0,tag:void 0,url:void 0}),h=()=>{_.value=!0,G({page:n.currentPage,page_size:n.pageSize,created_by:a.created_by||void 0,hash:a.hash||void 0,key:a.key||void 0,name:a.name||void 0,tag:a.tag||void 0,url:a.url||void 0}).then(s=>{n.total=s.data.total,V.value=s.data.list}).catch(()=>{V.value=[]}).finally(()=>{_.value=!1})},z=()=>{n.currentPage===1?h():n.currentPage=1},F=()=>{var s;(s=C.value)==null||s.resetFields(),z()},M=()=>{h()};X([()=>n.currentPage,()=>n.pageSize],h,{immediate:!0});const N=Y(()=>s=>I(s));return(s,o)=>{const p=i("el-input"),d=i("el-form-item"),f=i("el-button"),R=i("el-form"),S=i("el-card"),$=i("el-upload"),u=i("el-table-column"),q=i("el-table"),O=i("el-pagination"),x=P("loading"),D=P("permission");return c(),ee("div",te,[v((c(),b(S,{shadow:"never",class:"search-wrapper"},{default:t(()=>[e(R,{ref_key:"searchFormRef",ref:C,inline:!0,model:a},{default:t(()=>[e(d,{prop:"createdBy",label:"创建人"},{default:t(()=>[e(p,{modelValue:a.created_by,"onUpdate:modelValue":o[0]||(o[0]=l=>a.created_by=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(d,{prop:"hash",label:"文件hash"},{default:t(()=>[e(p,{modelValue:a.hash,"onUpdate:modelValue":o[1]||(o[1]=l=>a.hash=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(d,{prop:"key",label:"编号"},{default:t(()=>[e(p,{modelValue:a.key,"onUpdate:modelValue":o[2]||(o[2]=l=>a.key=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(d,{prop:"name",label:"文件名"},{default:t(()=>[e(p,{modelValue:a.name,"onUpdate:modelValue":o[3]||(o[3]=l=>a.name=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(d,{prop:"tag",label:"文件标签"},{default:t(()=>[e(p,{modelValue:a.tag,"onUpdate:modelValue":o[4]||(o[4]=l=>a.tag=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(d,{prop:"url",label:"文件地址"},{default:t(()=>[e(p,{modelValue:a.url,"onUpdate:modelValue":o[5]||(o[5]=l=>a.url=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[e(f,{type:"primary",onClick:z},{default:t(()=>[m("查询")]),_:1}),e(f,{onClick:F},{default:t(()=>[m("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})),[[x,_.value]]),v((c(),b(S,{shadow:"never"},{default:t(()=>[y("div",le,[y("div",null,[e($,{"file-list":k.value,"onUpdate:fileList":o[6]||(o[6]=l=>k.value=l),class:"upload-demo",action:`${r(U)}${r(w)}`,"show-file-list":!1,headers:{Authorization:"Bearer "+r(E)},"on-success":M},{default:t(()=>[v((c(),b(f,{type:"primary"},{default:t(()=>[m("上传文件")]),_:1})),[[D,r(w)+"_POST"]])]),_:1},8,["file-list","action","headers"])])]),y("div",oe,[e(q,{data:V.value},{default:t(()=>[e(u,{prop:"hash",label:"hash","min-width":"110"}),e(u,{prop:"key",label:"编号","min-width":"110"}),e(u,{prop:"name",label:"文件名","min-width":"160"}),e(u,{prop:"tag",label:"文件标签","min-width":"110"}),e(u,{prop:"url",label:"文件地址","min-width":"110"}),e(u,{prop:"created_at",label:"时间","min-width":"110"},{default:t(l=>[m(ae(N.value(l.row.created_at)),1)]),_:1}),e(u,{label:"操作",width:"150",align:"center"},{default:t(l=>[v((c(),b(f,{type:"danger",text:"",bg:"",size:"small",onClick:ie=>L(l.row)},{default:t(()=>[m("删除")]),_:2},1032,["onClick"])),[[D,r(w)+"_DELETE"]])]),_:1})]),_:1},8,["data"])]),y("div",ne,[e(O,{background:"",layout:r(n).layout,"page-sizes":r(n).pageSizes,total:r(n).total,"page-size":r(n).pageSize,currentPage:r(n).currentPage,onSizeChange:r(T),onCurrentChange:r(B)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])]),_:1})),[[x,_.value]])])}}}),fe=H(re,[["__scopeId","data-v-f25b34c2"]]);export{fe as default};
