import{A as ae,r as te,B as oe,E as S,C as ne}from"./element-V6-G1TdP.js";import{u as re}from"./usePagination-rdI7J7GV.js";import{g as ue}from"./dict-KXqkcwU_.js";import{r as x,_ as de}from"./index-NDpfkETP.js";import{l as se,r as g,Z as $,b as ie,ag as i,aq as M,m as c,p as B,V as w,M as b,O as t,T as e,F as N,u,a7 as G,S as y,q as U}from"./vue-ZDMaqQfr.js";import"./index-BAI4yJQ6.js";import"./index-zXEzR83g.js";import"./vxe-SD4sv8pp.js";const v="/v1/admin/config";function pe(p){return x({url:v,method:"post",data:p})}function me(p){return x({url:v,method:"delete",data:p})}function ce(p,k){return x({url:v+"/"+p,method:"put",data:k})}function ve(p){return x({url:v,method:"get",params:p})}function fe(p){return x({url:v+"/"+p,method:"get"})}const _e={class:"app-container"},ge={class:"toolbar-wrapper"},be={class:"table-wrapper"},ye={class:"pager-wrapper"},ke=se({name:"config",__name:"index",setup(p){const k=g(!1),{paginationData:d,handleCurrentChange:j,handleSizeChange:A}=re(),f=g(!1),z=g(null),r=g({}),I=$({path:[{required:!0,trigger:"blur",message:"请输入api路径"}],description:[{required:!0,trigger:"blur",message:"请输入api简介"}],apiGroup:[{required:!0,trigger:"blur",message:"请输入api分组"}]}),Z=()=>{var o;(o=z.value)==null||o.validate((a,m)=>{a?V.value===void 0?pe(r.value).then(()=>{S.success("新增成功"),h()}).finally(()=>{f.value=!1}):ce(V.value,{...r.value}).then(()=>{S.success("修改成功"),h()}).finally(()=>{f.value=!1}):console.error("表单校验不通过",m)})},H=()=>{var o;V.value=void 0,(o=z.value)==null||o.resetFields(),r.value={}},J=o=>{ne.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{me({key:[o.key]}).then(()=>{S.success("删除成功"),h()})})},V=g(void 0),Q=o=>{fe(o.key).then(a=>{V.value=o.key,Object.assign(r.value,a.data||{}),f.value=!0})},D=g([]),T=g(null),n=$({label:"",key:"",value:"",type:"",remark:""}),h=()=>{k.value=!0,ve({page:d.currentPage,page_size:d.pageSize,label:n.label||void 0,key:n.key||void 0,value:n.value||void 0,type:n.type||void 0,remark:n.remark||void 0}).then(o=>{d.total=o.data.total,D.value=o.data.list}).catch(()=>{D.value=[]}).finally(()=>{k.value=!1})},E=()=>{d.currentPage===1?h():d.currentPage=1},W=()=>{var o;(o=T.value)==null||o.resetFields(),E()},F=ue("system_setting_type");return ie([()=>d.currentPage,()=>d.pageSize],h,{immediate:!0}),(o,a)=>{const m=i("el-input"),s=i("el-form-item"),q=i("el-option"),L=i("el-select"),_=i("el-button"),R=i("el-form"),K=i("el-card"),C=i("el-table-column"),X=i("el-table"),Y=i("el-pagination"),ee=i("el-dialog"),O=M("loading"),P=M("permission");return c(),B("div",_e,[w((c(),b(K,{shadow:"never",class:"search-wrapper"},{default:t(()=>[e(R,{ref_key:"searchFormRef",ref:T,inline:!0,model:n},{default:t(()=>[e(s,{prop:"label",label:"Label"},{default:t(()=>[e(m,{modelValue:n.label,"onUpdate:modelValue":a[0]||(a[0]=l=>n.label=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(s,{prop:"key",label:"Key"},{default:t(()=>[e(m,{modelValue:n.key,"onUpdate:modelValue":a[1]||(a[1]=l=>n.key=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(s,{prop:"value",label:"Value"},{default:t(()=>[e(m,{modelValue:n.value,"onUpdate:modelValue":a[2]||(a[2]=l=>n.value=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(s,{prop:"type",label:"类型"},{default:t(()=>[e(L,{modelValue:n.type,"onUpdate:modelValue":a[3]||(a[3]=l=>n.type=l)},{default:t(()=>[(c(!0),B(N,null,G(u(F),l=>(c(),b(q,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(s,{prop:"remark",label:"备注"},{default:t(()=>[e(m,{modelValue:n.remark,"onUpdate:modelValue":a[4]||(a[4]=l=>n.remark=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(s,null,{default:t(()=>[e(_,{type:"primary",icon:u(ae),onClick:E},{default:t(()=>[y("查询")]),_:1},8,["icon"]),e(_,{icon:u(te),onClick:W},{default:t(()=>[y("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1})),[[O,k.value]]),w((c(),b(K,{shadow:"never"},{default:t(()=>[U("div",ge,[U("div",null,[w((c(),b(_,{type:"primary",icon:u(oe),onClick:a[5]||(a[5]=l=>f.value=!0)},{default:t(()=>[y("新增系统配置")]),_:1},8,["icon"])),[[P,u(v)+"_POST"]])])]),U("div",be,[e(X,{data:D.value},{default:t(()=>[e(C,{prop:"label",label:"Label","min-width":"110"}),e(C,{prop:"key",label:"Key","min-width":"110"}),e(C,{prop:"type",label:"类型","min-width":"160"}),e(C,{prop:"remark",label:"备注","min-width":"110"}),e(C,{label:"操作",width:"150",align:"center"},{default:t(l=>[w((c(),b(_,{type:"primary",text:"",bg:"",size:"small",onClick:le=>Q(l.row)},{default:t(()=>[y("修改")]),_:2},1032,["onClick"])),[[P,u(v)+"/:id_PUT"]]),w((c(),b(_,{type:"danger",text:"",bg:"",size:"small",onClick:le=>J(l.row)},{default:t(()=>[y("删除")]),_:2},1032,["onClick"])),[[P,u(v)+"_DELETE"]])]),_:1})]),_:1},8,["data"])]),U("div",ye,[e(Y,{background:"",layout:u(d).layout,"page-sizes":u(d).pageSizes,total:u(d).total,"page-size":u(d).pageSize,currentPage:u(d).currentPage,onSizeChange:u(A),onCurrentChange:u(j)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])]),_:1})),[[O,k.value]]),e(ee,{modelValue:f.value,"onUpdate:modelValue":a[12]||(a[12]=l=>f.value=l),title:V.value===void 0?"新增":"修改",onClose:H,width:"30%"},{footer:t(()=>[e(_,{onClick:a[11]||(a[11]=l=>f.value=!1)},{default:t(()=>[y("取消")]),_:1}),e(_,{type:"primary",onClick:Z},{default:t(()=>[y("确认")]),_:1})]),default:t(()=>[e(R,{ref_key:"formRef",ref:z,model:r.value,rules:I,"label-width":"100px","label-position":"right"},{default:t(()=>[e(s,{prop:"key",label:"Key"},{default:t(()=>[e(m,{modelValue:r.value.key,"onUpdate:modelValue":a[6]||(a[6]=l=>r.value.key=l),disabled:V.value!==void 0,placeholder:"请输入"},null,8,["modelValue","disabled"])]),_:1}),e(s,{label:"类型:",prop:"type"},{default:t(()=>[e(L,{modelValue:r.value.type,"onUpdate:modelValue":a[7]||(a[7]=l=>r.value.type=l),placeholder:"请选择展示方式",clearable:""},{default:t(()=>[(c(!0),B(N,null,G(u(F),l=>(c(),b(q,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"Value:",prop:"value"},{default:t(()=>[e(m,{type:"textarea",modelValue:r.value.value,"onUpdate:modelValue":a[8]||(a[8]=l=>r.value.value=l),placeholder:"请填写值选项，格式：label=value，一行一个"},null,8,["modelValue"])]),_:1}),e(s,{prop:"label",label:"中文名称:"},{default:t(()=>[e(m,{modelValue:r.value.label,"onUpdate:modelValue":a[9]||(a[9]=l=>r.value.label=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(s,{prop:"remark",label:"备注:"},{default:t(()=>[e(m,{type:"textarea",modelValue:r.value.remark,"onUpdate:modelValue":a[10]||(a[10]=l=>r.value.remark=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),Pe=de(ke,[["__scopeId","data-v-9c367c82"]]);export{Pe as default};
